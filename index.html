<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PDF OCR Tool | Advocate / CSC</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

<style>
body{font-family:Arial;background:#f4f6f8;margin:0}
.container{max-width:600px;margin:20px auto;background:#fff;padding:20px;border-radius:8px}
h2{text-align:center;color:#1a237e}
input,select,button,textarea{width:100%;padding:10px;margin:8px 0;font-size:16px}
button{background:#1a237e;color:#fff;border:none;border-radius:5px}
#loading{text-align:center;font-weight:bold;display:none}
.brand{text-align:center;font-size:13px;color:#555;margin-top:10px}
</style>
</head>

<body>
<div class="container">
<h2>PDF to OCR Tool</h2>

<input type="file" id="pdfFile" accept="application/pdf">

<select id="lang">
<option value="eng">English</option>
<option value="hin">Hindi</option>
<option value="mar">Marathi</option>
</select>

<button onclick="startOCR()">Start OCR</button>

<div id="loading">⏳ Processing PDF… Please wait</div>

<textarea id="result" placeholder="Extracted text will appear here"></textarea>

<button onclick="downloadText()">Download Text</button>

<div class="brand">
Powered by Krishna Londhe | Advocate / CSC
</div>
</div>

<script>
pdfjsLib.GlobalWorkerOptions.workerSrc =
'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

async function startOCR(){
const file=document.getElementById("pdfFile").files[0];
if(!file){ alert("Upload PDF"); return; }

document.getElementById("loading").style.display="block";
document.getElementById("result").value="";

const lang=document.getElementById("lang").value;
const reader=new FileReader();
reader.readAsArrayBuffer(file);

reader.onload=async function(){
const pdf=await pdfjsLib.getDocument({data:reader.result}).promise;
let finalText="";

const worker=await Tesseract.createWorker(lang);

for(let i=1;i<=pdf.numPages;i++){
const page=await pdf.getPage(i);
const viewport=page.getViewport({scale:2});
const canvas=document.createElement("canvas");
canvas.width=viewport.width;
canvas.height=viewport.height;

await page.render({
canvasContext:canvas.getContext("2d"),
viewport
}).promise;

const { data:{ text }} = await worker.recognize(canvas);
finalText += text + "\n\n";
}

await worker.terminate();
document.getElementById("result").value=finalText;
document.getElementById("loading").style.display="none";
}
}

function downloadText(){
const text=document.getElementById("result").value;
const blob=new Blob([text],{type:"text/plain"});
const a=document.createElement("a");
a.href=URL.createObjectURL(blob);
a.download="ocr-text.txt";
a.click();
}
</script>
</body>
</html>
